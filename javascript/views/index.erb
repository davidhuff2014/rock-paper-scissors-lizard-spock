<!doctype>
<html>
	<head>
		<title>Rock Paper Scissors Lizard Spock</title>
		<link href="./css/style.css" rel="stylesheet">
		<meta charset="utf8">
    </head>
    <body>
    	<div class="div-special main-frame">
	    	<table class="framework">
	    		<tr>
	    			<td class="td-narrow">
	    			</td>
	    			<td class="td-wide page-title">
	    			    <h1>
	    			    	<span>Rock Paper Scissors Lizard Spock</span>
	    			    </h1>
	    			</td class="td-narrow">
	    			<td>
	    			</td>
	    		</tr>
	    		<tr>
	    		 	<td class="td-narrow">
	    			</td>
	    			<td class="td-wide">
	    				<table class="choices">
	    					<tr>
		    					<td align="center">
		    						<img class="game-img" src="images/rock.png" data-pick='rock'>
		    					</td>
		    					<td align="center">
		 	 	     				<img class="game-img" src="images/paper.png" data-pick='paper'>
		    					</td>
		    					<td align="center">
									<img class="game-img" src="images/scissors.png" data-pick='scissors'>
		      					</td>
		      					<td align="center">
				    				<img class="game-img" src="images/lizard.png" data-pick='lizard'>
		      					</td>
		      					<td align="center">
		    						<img class="game-img" src="images/spock.png" data-pick='spock'>
		      					</td>
	    					</tr>
	    				</table>
	       			</td>
	       			<td class="td-narrow">
	    			</td>
	    		</tr>
	    		<tr class="tr-special">
	 				<td class="td-narrow">
	    			</td>
	    			<td class="td-specical"> 
	    				<h3 id="message"></h3>
	    			</td>
	    			<td class="td-narrow">
	    			</td>
	    		</tr>
	    		<tr>
	    			<td class="td-narrow">
	    			</td>
	  	 			<td class="td-wide">
	  	 				<table class="buttons table-special">
	  	 					<tr>
					 			<td id="first_box" align="center" width=50% valign="center" height="65px">
				    				<p><button type="button" class="gameModeButton" id="one_player">Player vs Deep Thought</button></p>
				    				<p><input type="text" class="player_name" placeholder="Player One" id="player1_name" required="true" autofocus></input> </p> 
				    			</td>
				    			<td id="second_box" valign= "center" align="center" height="65px">
				    				<p><button type="button" class="gameModeButton" id="two_players">Player vs Player</button></p>
				    				<p><input type="text" class="player_name" placeholder="Player Two" id="player2_name" required></input></p>
				    			</td>
	  	 					</tr>
	  	 				</table>
	    			</td>
	    			<td class="td-narrow">
	    			</td>
	    		</tr>
	    		<tr>
	    			<td class="td-narrow">
	    			</td>
	    			<td class="td-specical">
	   	 				<table class="buttons table-special">
	  	 					<tr>
	    						<td id="result_box" width=70% align="center" valign="center" height="75px"> 
									<h3 class="h-special" id="resultMessage"></h3>
				    			  	<button type="button" class="submit_name_button" valign="center" id="submit_1">Submit</button>
				    			</td>
	  	 					</tr>
	  	 				</table>
		 			</td>
		 			<td class="td-narrow">
	    			</td>
	    		</tr>
	    		<tr>
	    			<td class="td-narrow">
	    			</td>
	    			<td class="td-specical">
				    		<button type="button" class="restart_button" id="restart">Restart Game</button>
	 		 			</td>
		 			<td>
	    			</td>
	    		</tr>
	    	</table>
    	</div>

		<div class="container">
	    	<div id="powered-by" style="width: 100px">
		    	<p>Powered by:</p>
		    </div>
		    <div>
           		<a href='http://en.wikipedia.org/wiki/Test-driven_development'> 
                	<img src="images/footer/tdd_small.png" style="margin-top: 2px;" />
            	</a>
		    </div>
		    <div>
           		<a href='http://jquery.com/'> 
                	<img src="images/footer/jquery_small.png" />
            	</a>
		    </div>
		    <div>
		    	<a href='http://www.w3schools.com/html/html5_intro.asp'> 
                	<img src="images/footer/html5_small.png" />
            	</a>
		    </div>	
		    <div>
		    	<a href='http://www.w3.org/TR/2001/WD-css3-roadmap-20010523/'>
                	<img src="images/footer/css3_small.png" />
            	</a>
		    </div>
		    <div>
		    	<a href='http://www.sinatrarb.com/'>                 
                	<img src="images/footer/sinatra_small.png" style="margin-top: 2px;" />
            	</a>
		    </div>
		    <div>
           		<a href='https://www.heroku.com'> 
                	<img src="images/footer/heroku_small.png" />
            	</a>
		    </div>
		    <div>
		    	<a href='https://github.com/nadavmatalon/rock-paper-scissors-lizard-spock'>
                	<img src="images/footer/github_small.png" width="57px" height="57px" style="margin-top: 1px;" />
            	</a>
		    </div>
		    <div id="written-by" style="width: 200px">
		    	<span>Written by:</span>
       			<a href='https://github.com/nadavmatalon'> 
            		<img src="images/footer/nmqr_small.png" width="55px" height="55px" style="margin-top: 4px;" />
        		</a>		    	
		    </div>
		</div>

    	<script src='lib/RockPaperScissorsLizardSpock.js'></script>
    	<script src='lib/jquery-2.1.1.min.js'></script>
    	<script src='https://code.jquery.com/jquery-2.1.1.min.js'></script>
    	<script>

    	playGame();

    		function playGame() {
    			$(document).ready(function() {
 					createNewGame();
					selectGameMode();
    			});
    		};

    		function createNewGame() {
  				window.p1 = new Player("");
    			window.p2 = new Player("");
    			window.game = new Game(p1, p2);
    			window.message = "";
    			window.resultMessage="";
    			appendMainMessage();
    			resetPlayersPicks();
    		};

    		function appendMainMessage() {
				$("#message").append("<h3>" + message + "</h3>");
    		};

   			function appendResultMessage() {
				$("#result_box").append("<h3>" + resultMessage + "</h3>");
    		};

    		function resetPlayersPicks() {
              	p1.pick = null;
              	p2.pick = null;
      		};

			function updateMainMessage(message) {
					$('#message').fadeOut(200, function() {
					$('#message').text(message).fadeIn(200);
				});
			};

			function updateResultMessage(result_message) {
				$('#resultMessage').fadeOut(200, function() {
					$('#resultMessage').text(result_message).fadeIn(200);
				});
			};

			function selectGameMode() {
				$(".gameModeButton").fadeIn(200);
				updateMainMessage("Welcome, please select game mode");

				$('#one_player').on('click', function() {
					setSinglePlayerMode();
				});
				$('#two_players').on('click', function() {
					setTwoPlayersMode();
				});
			};
            
			function setSinglePlayerMode() {
				setPlayersNames("single");
				$("#submit_1").on('click', function() {
					if ($('#player1_name').val() != "") {
							p1.name = $('#player1_name').val();
						$('#player1_name').fadeOut(function() {
							$(this).remove();
						});
						$("#submit_1").fadeOut(function() {
							$(this).remove(function(){
								appendResultMessage();
							});
						});
						$("#first_box").text(p1.name);
						playerVsComputer();
					} else {
						updateMainMessage("Please enter name to begin");
					};
				});
			};

			function setTwoPlayersMode() {
				name_one_check = false;
				name_two_check = false;
				setPlayersNames("twoPlayers");
				$('#submit_1').on('click', function() {
					if ($('#player1_name').val() != "" && !name_one_check) {
						p1.name = $('#player1_name').val();
						$('#player1_name').fadeOut();
						$('#first_box').text(p1.name);
						name_one_check = true;
					};	
					if ($('#player2_name').val() != "" && !name_two_check) {
						p2.name = $('#player2_name').val();
						$('#player2_name').fadeOut();
						$('#second_box').text(p2.name);
						name_two_check = true;
					};
					if (name_one_check && name_two_check) {				  					
						$('#submit_1').fadeOut(function(){
							$(this).remove(function(){
								appendResultMessage();
							});
						});
						playerVsPlayer();
					} else {
						updateMainMessage("Please enter both names to begin");
					};
				});
			};

			function setPlayersNames(mode) {
				$('.gameModeButton').remove();
				$('#player1_name').fadeIn();
				$('#submit_1').fadeIn();
				if (mode === "single") {
					updateMainMessage("Please enter your name:");
					p2.name = "Deep Thought";
					$('#second_box').text(p2.name);
				};
				if (mode === "twoPlayers") {
					updateMainMessage("Please enter your names:");
					$('#player2_name').fadeIn(200);	
				};
			};

			function playerVsComputer() {
				updateMainMessage(p1.name + " , click on image to make your move!");
				$('#restart').fadeIn(200);
				$('.choices img').on('click', function() {
  	    			p1.picks($(this).data('pick'));
					p2.picks(randomPick());
  	    			showWinningMessage();
  	    			showPicksAndWinningMessageInConsole();
				});
				$('#restart').on('click', function() {
					restartGame();
	 	   		});
			};

   			function randomPick() {
    			selection = ["rock", "paper", "scissors", "lizard", "spock"];
    			return selection[Math.floor(Math.random() * selection.length)];
    		};

			function playerVsPlayer() {
				updateMainMessage(p1.name + " and " + p2.name + ", click on images to make your moves!");
				$('#restart').fadeIn(200);
       			$('.choices img').on('click', function() {
          			if (p1.pick === null) {
          				p1.picks($(this).data('pick'));
          			} else {
          				p2.picks($(this).data('pick'));
						showWinningMessage();
              			showPicksAndWinningMessageInConsole();            		
              			resetPlayersPicks();
          			};
        		});
        		$('#restart').on('click', function() {
					restartGame();
				});
	 		};

			function showWinningMessage() {
				updateResultMessage(game.winningMessage());
			};

   			function showPicksInConsole() {
    			console.log(p1.name + " picked: " + p1.pick);
	  	    	console.log(p2.name + " picked: " + p2.pick);
    		};

    		function showWinningMessageInConsole() {
    			console.log(game.winningMessage());
    		};

    		function showPicksAndWinningMessageInConsole() {
    			showPicksInConsole();
				showWinningMessageInConsole();
    		};

			function restartGame() {
    			location.reload();
    		};
		</script>
	</body>
</html>
